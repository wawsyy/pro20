{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///D:/Cursor-Ku/demo20/pro20/frontend/hooks/useEthersSigner.ts"],"sourcesContent":["import { useMemo } from 'react';\r\nimport { useWalletClient } from 'wagmi';\r\nimport { BrowserProvider, JsonRpcSigner } from 'ethers';\r\n\r\nfunction walletClientToSigner(walletClient: any): Promise<JsonRpcSigner> {\r\n  const { account, chain, transport } = walletClient;\r\n  const network = {\r\n    chainId: chain.id,\r\n    name: chain.name,\r\n    ensAddress: chain.contracts?.ensRegistry?.address,\r\n  };\r\n\r\n  const provider = new BrowserProvider(transport, network);\r\n  const signer = provider.getSigner(account.address);\r\n  return signer;\r\n}\r\n\r\nexport function useEthersSigner({ chainId }: { chainId?: number } = {}) {\r\n  const { data: walletClient } = useWalletClient({ chainId });\r\n\r\n  return useMemo(\r\n    () => (walletClient ? walletClientToSigner(walletClient) : undefined),\r\n    [walletClient]\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,SAAS,qBAAqB,YAAiB;IAC7C,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG;IACtC,MAAM,UAAU;QACd,SAAS,MAAM,EAAE;QACjB,MAAM,MAAM,IAAI;QAChB,YAAY,MAAM,SAAS,EAAE,aAAa;IAC5C;IAEA,MAAM,WAAW,IAAI,uMAAe,CAAC,WAAW;IAChD,MAAM,SAAS,SAAS,SAAS,CAAC,QAAQ,OAAO;IACjD,OAAO;AACT;AAEO,SAAS,gBAAgB,EAAE,OAAO,EAAwB,GAAG,CAAC,CAAC;IACpE,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,IAAA,+LAAe,EAAC;QAAE;IAAQ;IAEzD,OAAO,IAAA,4NAAO,EACZ,IAAO,eAAe,qBAAqB,gBAAgB,WAC3D;QAAC;KAAa;AAElB","debugId":null}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///D:/Cursor-Ku/demo20/pro20/frontend/hooks/useZamaInstance.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { ethers } from 'ethers';\n\n// SDK CDN URL\nconst SDK_CDN_URL = 'https://cdn.zama.ai/relayer-sdk-js/0.2.0/relayer-sdk-js.umd.cjs';\n\n// Local network chain ID\nconst LOCAL_CHAIN_ID = 31337;\nconst LOCAL_RPC_URL = 'http://localhost:8545';\n\n// Type definitions for window.relayerSDK\ndeclare global {\n  interface Window {\n    relayerSDK?: {\n      initSDK: (options?: any) => Promise<boolean>;\n      createInstance: (config: any) => Promise<any>;\n      SepoliaConfig: any;\n      __initialized__?: boolean;\n    };\n  }\n}\n\nfunction isSDKLoaded(): boolean {\n  if (typeof window === 'undefined') return false;\n  return typeof window.relayerSDK !== 'undefined' && \n         typeof window.relayerSDK?.initSDK === 'function' &&\n         typeof window.relayerSDK?.createInstance === 'function' &&\n         window.relayerSDK?.SepoliaConfig !== undefined;\n}\n\nfunction loadSDKFromCDN(): Promise<void> {\n  return new Promise((resolve, reject) => {\n    // Check if already loaded\n    if (isSDKLoaded()) {\n      resolve();\n      return;\n    }\n\n    // Check if script already exists\n    const existingScript = document.querySelector(`script[src=\"${SDK_CDN_URL}\"]`);\n    if (existingScript) {\n      // Wait a bit for script to load\n      const checkInterval = setInterval(() => {\n        if (isSDKLoaded()) {\n          clearInterval(checkInterval);\n          resolve();\n        }\n      }, 100);\n\n      // Timeout after 10 seconds\n      setTimeout(() => {\n        clearInterval(checkInterval);\n        if (!isSDKLoaded()) {\n          reject(new Error('SDK script loaded but window.relayerSDK is not available'));\n        }\n      }, 10000);\n      return;\n    }\n\n    // Create and load script\n    const script = document.createElement('script');\n    script.src = SDK_CDN_URL;\n    script.type = 'text/javascript';\n    script.async = true;\n\n    script.onload = () => {\n      if (!isSDKLoaded()) {\n        reject(new Error(`SDK script loaded from ${SDK_CDN_URL}, but window.relayerSDK is invalid`));\n        return;\n      }\n      resolve();\n    };\n\n    script.onerror = () => {\n      reject(new Error(`Failed to load SDK from ${SDK_CDN_URL}`));\n    };\n\n    document.head.appendChild(script);\n  });\n}\n\n// Fetch relayer metadata from Hardhat node using RPC call\nasync function fetchHardhatNodeRelayerMetadata(rpcUrl: string): Promise<{\n  ACLAddress: `0x${string}`;\n  InputVerifierAddress: `0x${string}`;\n  KMSVerifierAddress: `0x${string}`;\n} | null> {\n  try {\n    const provider = new ethers.JsonRpcProvider(rpcUrl);\n    // Use fhevm_relayer_metadata RPC method\n    const metadata = await provider.send('fhevm_relayer_metadata', []);\n    \n    if (metadata && \n        typeof metadata.ACLAddress === 'string' && metadata.ACLAddress.startsWith('0x') &&\n        typeof metadata.InputVerifierAddress === 'string' && metadata.InputVerifierAddress.startsWith('0x') &&\n        typeof metadata.KMSVerifierAddress === 'string' && metadata.KMSVerifierAddress.startsWith('0x')) {\n      return {\n        ACLAddress: metadata.ACLAddress as `0x${string}`,\n        InputVerifierAddress: metadata.InputVerifierAddress as `0x${string}`,\n        KMSVerifierAddress: metadata.KMSVerifierAddress as `0x${string}`,\n      };\n    }\n  } catch (err) {\n    console.warn('[useZamaInstance] Failed to fetch Hardhat node metadata:', err);\n  }\n  return null;\n}\n\n// Create mock instance for local network\nasync function createMockInstance(chainId: number, rpcUrl: string): Promise<any> {\n  console.log('[useZamaInstance] Creating mock instance for local network...');\n  \n  // Fetch metadata from Hardhat node\n  const metadata = await fetchHardhatNodeRelayerMetadata(rpcUrl);\n  if (!metadata) {\n    throw new Error('Failed to fetch relayer metadata from Hardhat node. Make sure Hardhat node is running with FHEVM plugin.');\n  }\n\n  // Dynamically import mock utils to avoid including in production bundle\n  const { MockFhevmInstance } = await import('@fhevm/mock-utils');\n  const provider = new ethers.JsonRpcProvider(rpcUrl);\n  \n  const instance = await MockFhevmInstance.create(provider, provider, {\n    aclContractAddress: metadata.ACLAddress,\n    chainId: chainId,\n    gatewayChainId: 55815,\n    inputVerifierContractAddress: metadata.InputVerifierAddress,\n    kmsContractAddress: metadata.KMSVerifierAddress,\n    verifyingContractAddressDecryption: '0x5ffdaAB0373E62E2ea2944776209aEf29E631A64',\n    verifyingContractAddressInputVerification: '0x812b06e1CDCE800494b79fFE4f925A504a9A9810',\n  });\n\n  console.log('[useZamaInstance] Mock instance created');\n  return instance;\n}\n\nexport function useZamaInstance(chainId?: number, provider?: ethers.Eip1193Provider | string) {\n  const [instance, setInstance] = useState<any>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    // Only run in browser\n    if (typeof window === 'undefined') {\n      return;\n    }\n\n    let mounted = true;\n\n    const initZama = async () => {\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // Check if this is local network - use mock mode\n        if (chainId === LOCAL_CHAIN_ID) {\n          console.log('[useZamaInstance] Using mock mode for local network');\n          const mockInstance = await createMockInstance(LOCAL_CHAIN_ID, LOCAL_RPC_URL);\n          if (mounted) {\n            setInstance(mockInstance);\n          }\n          return;\n        }\n\n        // For other networks (like Sepolia), use real relayer\n        if (!chainId || chainId !== 11155111) {\n          console.warn('[useZamaInstance] Unsupported network:', chainId);\n          if (mounted) {\n            setError(`Unsupported network: ${chainId}. Only Hardhat Local (31337) and Sepolia (11155111) are supported.`);\n          }\n          return;\n        }\n\n        console.log('[useZamaInstance] Loading SDK from CDN for Sepolia network');\n        await loadSDKFromCDN();\n        console.log('[useZamaInstance] SDK loaded from CDN');\n\n        if (!window.relayerSDK) {\n          throw new Error('window.relayerSDK is not available after loading');\n        }\n\n        // Initialize SDK\n        console.log('[useZamaInstance] Initializing SDK...');\n        if (!window.relayerSDK.__initialized__) {\n          const initResult = await window.relayerSDK.initSDK();\n          window.relayerSDK.__initialized__ = initResult;\n          if (!initResult) {\n            throw new Error('SDK initialization failed');\n          }\n        }\n        console.log('[useZamaInstance] SDK initialized');\n\n        // Get provider - validate it's a valid EIP-1193 provider\n        const networkProvider = provider || (typeof window !== 'undefined' && (window as any).ethereum) || undefined;\n        if (!networkProvider) {\n          throw new Error('No provider available. Please connect your wallet.');\n        }\n\n        // Validate provider has required EIP-1193 methods\n        if (typeof networkProvider.request !== 'function') {\n          throw new Error('Invalid EIP-1193 provider: missing request method');\n        }\n\n        // Get ACL address from SepoliaConfig\n        const aclAddress = window.relayerSDK.SepoliaConfig?.aclContractAddress;\n        if (!aclAddress) {\n          throw new Error('ACL address not found in SepoliaConfig');\n        }\n\n        // Create config with network provider\n        // The SDK expects the provider to be a valid EIP-1193 provider\n        const config = {\n          ...window.relayerSDK.SepoliaConfig,\n          network: networkProvider,\n        };\n\n        console.log('[useZamaInstance] Creating instance with config:', {\n          aclContractAddress: config.aclContractAddress,\n          chainId: config.chainId,\n          hasNetwork: !!config.network,\n          providerType: typeof networkProvider,\n          hasRequest: typeof networkProvider.request === 'function',\n        });\n\n        // Create instance with retry logic for relayer connection issues\n        let zamaInstance;\n        const maxRetries = 3;\n        let lastError: any = null;\n        \n        for (let attempt = 1; attempt <= maxRetries; attempt++) {\n          try {\n            console.log(`[useZamaInstance] Attempting to create instance (attempt ${attempt}/${maxRetries})...`);\n            zamaInstance = await window.relayerSDK.createInstance(config);\n            console.log('[useZamaInstance] Instance created successfully');\n            break;\n          } catch (err: any) {\n            lastError = err;\n            const isRelayerError = err?.message?.includes('Relayer') || \n                                  err?.message?.includes('Bad JSON') ||\n                                  err?.message?.includes('connection');\n            \n            if (isRelayerError && attempt < maxRetries) {\n              const delay = attempt * 2000; // Exponential backoff: 2s, 4s, 6s\n              console.warn(`[useZamaInstance] Relayer connection failed, retrying in ${delay}ms... (attempt ${attempt}/${maxRetries})`);\n              await new Promise(resolve => setTimeout(resolve, delay));\n              continue;\n            }\n            throw err;\n          }\n        }\n        \n        if (!zamaInstance) {\n          throw lastError || new Error('Failed to create Zama instance after retries');\n        }\n\n        if (mounted) {\n          setInstance(zamaInstance);\n        }\n      } catch (err: any) {\n        console.error('[useZamaInstance] Failed to initialize Zama instance:', err);\n        console.error('[useZamaInstance] Error details:', {\n          message: err?.message,\n          stack: err?.stack,\n          name: err?.name\n        });\n        \n        // Provide user-friendly error messages\n        let errorMessage = err?.message || 'Failed to initialize encryption service';\n        if (err?.message?.includes('Relayer') || err?.message?.includes('Bad JSON')) {\n          errorMessage = 'Unable to connect to Zama relayer service. This may be a temporary network issue. Please try again in a few moments or switch to local network for testing.';\n        } else if (err?.message?.includes('connection') || err?.message?.includes('ERR_CONNECTION')) {\n          errorMessage = 'Network connection error. Please check your internet connection and try again.';\n        }\n        \n        if (mounted) {\n          setError(errorMessage);\n        }\n      } finally {\n        if (mounted) {\n          setIsLoading(false);\n        }\n      }\n    };\n\n    // Small delay to ensure window is ready\n    const timer = setTimeout(() => {\n      initZama();\n    }, 100);\n\n    return () => {\n      mounted = false;\n      clearTimeout(timer);\n    };\n  }, [chainId, provider]);\n\n  return { instance, isLoading, error };\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 248, "column": 0}, "map": {"version":3,"sources":["file:///D:/Cursor-Ku/demo20/pro20/frontend/abi/EncryptedDonationLogAddresses.ts"],"sourcesContent":["\n/*\n  This file is auto-generated.\n  Command: 'npm run genabi'\n*/\nexport const EncryptedDonationLogAddresses = { \n  \"11155111\": { address: \"0x7D43afa1E649EB6B2Af71B674227e13EEf3B09fA\", chainId: 11155111, chainName: \"sepolia\" },\n  \"31337\": { address: \"0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0\", chainId: 31337, chainName: \"hardhat\" },\n};\n"],"names":[],"mappings":"AACA;;;AAGA;;;;AACO,MAAM,gCAAgC;IAC3C,YAAY;QAAE,SAAS;QAA8C,SAAS;QAAU,WAAW;IAAU;IAC7G,SAAS;QAAE,SAAS;QAA8C,SAAS;QAAO,WAAW;IAAU;AACzG","debugId":null}},
    {"offset": {"line": 271, "column": 0}, "map": {"version":3,"sources":["file:///D:/Cursor-Ku/demo20/pro20/frontend/abi/EncryptedDonationLogABI.ts"],"sourcesContent":["\n/*\n  This file is auto-generated.\n  Command: 'npm run genabi'\n*/\nexport const EncryptedDonationLogABI = {\n  \"abi\": [\n    {\n      \"anonymous\": false,\n      \"inputs\": [\n        {\n          \"indexed\": true,\n          \"internalType\": \"uint256\",\n          \"name\": \"recordId\",\n          \"type\": \"uint256\"\n        },\n        {\n          \"indexed\": true,\n          \"internalType\": \"address\",\n          \"name\": \"viewer\",\n          \"type\": \"address\"\n        }\n      ],\n      \"name\": \"DonationDecrypted\",\n      \"type\": \"event\"\n    },\n    {\n      \"anonymous\": false,\n      \"inputs\": [\n        {\n          \"indexed\": true,\n          \"internalType\": \"uint256\",\n          \"name\": \"recordId\",\n          \"type\": \"uint256\"\n        },\n        {\n          \"indexed\": true,\n          \"internalType\": \"address\",\n          \"name\": \"submitter\",\n          \"type\": \"address\"\n        },\n        {\n          \"indexed\": false,\n          \"internalType\": \"uint256\",\n          \"name\": \"blockNumber\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"name\": \"DonationSubmitted\",\n      \"type\": \"event\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"recordId\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"name\": \"getEncryptedAmount\",\n      \"outputs\": [\n        {\n          \"internalType\": \"euint32\",\n          \"name\": \"\",\n          \"type\": \"bytes32\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"recordId\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"name\": \"getEncryptedTimestamp\",\n      \"outputs\": [\n        {\n          \"internalType\": \"euint32\",\n          \"name\": \"\",\n          \"type\": \"bytes32\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"recordId\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"name\": \"getRecordMetadata\",\n      \"outputs\": [\n        {\n          \"internalType\": \"address\",\n          \"name\": \"submitter\",\n          \"type\": \"address\"\n        },\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"blockNumber\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"address\",\n          \"name\": \"user\",\n          \"type\": \"address\"\n        }\n      ],\n      \"name\": \"getUserDonationCount\",\n      \"outputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"address\",\n          \"name\": \"user\",\n          \"type\": \"address\"\n        },\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"index\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"name\": \"getUserDonationIdAt\",\n      \"outputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [],\n      \"name\": \"nextRecordId\",\n      \"outputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [],\n      \"name\": \"protocolId\",\n      \"outputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"stateMutability\": \"pure\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"recordId\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"name\": \"recordExists\",\n      \"outputs\": [\n        {\n          \"internalType\": \"bool\",\n          \"name\": \"\",\n          \"type\": \"bool\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"name\": \"records\",\n      \"outputs\": [\n        {\n          \"internalType\": \"address\",\n          \"name\": \"submitter\",\n          \"type\": \"address\"\n        },\n        {\n          \"internalType\": \"euint32\",\n          \"name\": \"encryptedAmount\",\n          \"type\": \"bytes32\"\n        },\n        {\n          \"internalType\": \"euint32\",\n          \"name\": \"encryptedTimestamp\",\n          \"type\": \"bytes32\"\n        },\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"blockNumber\",\n          \"type\": \"uint256\"\n        },\n        {\n          \"internalType\": \"bool\",\n          \"name\": \"exists\",\n          \"type\": \"bool\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"externalEuint32\",\n          \"name\": \"encryptedAmount\",\n          \"type\": \"bytes32\"\n        },\n        {\n          \"internalType\": \"externalEuint32\",\n          \"name\": \"encryptedTimestamp\",\n          \"type\": \"bytes32\"\n        },\n        {\n          \"internalType\": \"bytes\",\n          \"name\": \"inputProof\",\n          \"type\": \"bytes\"\n        }\n      ],\n      \"name\": \"submitDonation\",\n      \"outputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"recordId\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"stateMutability\": \"nonpayable\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"address\",\n          \"name\": \"\",\n          \"type\": \"address\"\n        },\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"name\": \"userDonations\",\n      \"outputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    }\n  ]\n} as const;\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 572, "column": 0}, "map": {"version":3,"sources":["file:///D:/Cursor-Ku/demo20/pro20/frontend/components/DonationLogDemo.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useCallback } from \"react\";\nimport { ConnectButton } from '@rainbow-me/rainbowkit';\nimport { useAccount, usePublicClient, useChainId } from 'wagmi';\nimport { ethers } from \"ethers\";\nimport { readContract } from '@wagmi/core';\nimport { useEthersSigner } from \"@/hooks/useEthersSigner\";\nimport { useZamaInstance } from \"@/hooks/useZamaInstance\";\nimport { EncryptedDonationLogAddresses } from \"@/abi/EncryptedDonationLogAddresses\";\nimport { EncryptedDonationLogABI } from \"@/abi/EncryptedDonationLogABI\";\nimport { config as wagmiConfig } from \"@/config/wagmi\";\n\ninterface DonationRecord {\n  recordId: number;\n  amount: string;\n  timestamp: string;\n  blockNumber: string;\n}\n\nexport const DonationLogDemo = () => {\n  const { address, isConnected } = useAccount();\n  const chainId = useChainId(); // Use useChainId hook for more reliable chain detection\n  const publicClient = usePublicClient();\n  const ethersSignerPromise = useEthersSigner({ chainId });\n  \n  // Get provider - use window.ethereum directly for EIP-1193 compatibility\n  const provider = typeof window !== 'undefined' ? (window as any).ethereum : undefined;\n  const { instance: zama, isLoading: zamaLoading, error: zamaError } = useZamaInstance(chainId, provider);\n  const [mounted, setMounted] = useState(false);\n\n  const [donationAmount, setDonationAmount] = useState<string>(\"\");\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [donationRecords, setDonationRecords] = useState<DonationRecord[]>([]);\n  const [isLoadingRecords, setIsLoadingRecords] = useState(false);\n  const [message, setMessage] = useState<string>(\"\");\n  const [decryptingRecordId, setDecryptingRecordId] = useState<number | null>(null);\n\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  // Debug: Log chainId changes\n  useEffect(() => {\n    if (mounted && chainId) {\n      console.log('[DonationLogDemo] Current chainId:', chainId);\n      console.log('[DonationLogDemo] Contract address:', EncryptedDonationLogAddresses[chainId.toString()]?.address);\n    }\n  }, [chainId, mounted]);\n\n  const contractAddress = chainId ? EncryptedDonationLogAddresses[chainId.toString()]?.address : undefined;\n  const isDeployed = contractAddress && contractAddress !== ethers.ZeroAddress;\n\n  const loadDonationRecords = useCallback(async () => {\n    if (!isConnected || !address || !contractAddress || !publicClient) return;\n\n    setIsLoadingRecords(true);\n    try {\n      // Use viem readContract for view functions\n      let count: bigint = 0n;\n      try {\n        const countResult = await readContract(wagmiConfig, {\n          address: contractAddress as `0x${string}`,\n          abi: EncryptedDonationLogABI.abi,\n          functionName: 'getUserDonationCount',\n          args: [address as `0x${string}`],\n        });\n        count = typeof countResult === 'bigint' ? countResult : BigInt(countResult || 0);\n        console.log('[loadDonationRecords] getUserDonationCount result:', count);\n      } catch (err: any) {\n        // If call fails, user might have no records\n        console.log('[loadDonationRecords] getUserDonationCount failed, assuming 0:', err.message);\n        count = 0n;\n      }\n\n      const countNumber = Number(count);\n      const records: DonationRecord[] = [];\n\n      for (let i = 0; i < countNumber; i++) {\n        try {\n          const recordId = await readContract(wagmiConfig, {\n            address: contractAddress as `0x${string}`,\n            abi: EncryptedDonationLogABI.abi,\n            functionName: 'getUserDonationIdAt',\n            args: [address as `0x${string}`, BigInt(i)],\n          });\n          \n          const metadata = await readContract(wagmiConfig, {\n            address: contractAddress as `0x${string}`,\n            abi: EncryptedDonationLogABI.abi,\n            functionName: 'getRecordMetadata',\n            args: [typeof recordId === 'bigint' ? recordId : BigInt(recordId)],\n          });\n          \n          const recordIdNumber = typeof recordId === 'bigint' ? Number(recordId) : Number(recordId);\n          const blockNumber = typeof metadata === 'object' && metadata && 'blockNumber' in metadata\n            ? (typeof metadata.blockNumber === 'bigint' \n                ? metadata.blockNumber.toString() \n                : (metadata.blockNumber?.toString() || '0'))\n            : (typeof metadata === 'bigint' ? metadata.toString() : String(metadata || '0'));\n          \n          records.push({\n            recordId: recordIdNumber,\n            amount: \"Encrypted\",\n            timestamp: \"Encrypted\",\n            blockNumber: blockNumber,\n          });\n        } catch (err) {\n          console.error(`[loadDonationRecords] Error loading record ${i}:`, err);\n        }\n      }\n\n      setDonationRecords(records);\n    } catch (error: any) {\n      console.error(\"[loadDonationRecords] Error loading records:\", error);\n      setMessage(`Failed to load donation records: ${error.message || 'Unknown error'}`);\n    } finally {\n      setIsLoadingRecords(false);\n    }\n  }, [isConnected, address, contractAddress, publicClient]);\n\n  useEffect(() => {\n    if (isConnected && contractAddress) {\n      loadDonationRecords();\n    }\n  }, [isConnected, contractAddress, loadDonationRecords]);\n\n  const handleSubmitDonation = async () => {\n    if (!isConnected || !ethersSignerPromise || !zama || !contractAddress || !donationAmount) {\n      setMessage(\"Please connect wallet and enter donation amount\");\n      return;\n    }\n\n    setIsSubmitting(true);\n    setMessage(\"Submitting donation...\");\n\n    try {\n      const signer = await ethersSignerPromise;\n      const amount = parseInt(donationAmount);\n      const timestamp = Math.floor(Date.now() / 1000);\n\n      if (isNaN(amount) || amount <= 0) {\n        setMessage(\"Please enter a valid donation amount\");\n        setIsSubmitting(false);\n        return;\n      }\n\n      // Encrypt amount and timestamp\n      const encryptedInput = await zama.createEncryptedInput(contractAddress, address!)\n        .add32(amount)\n        .add32(timestamp)\n        .encrypt();\n\n      const contract = new ethers.Contract(\n        contractAddress,\n        EncryptedDonationLogABI.abi,\n        signer\n      );\n\n      const tx = await contract.submitDonation(\n        encryptedInput.handles[0],\n        encryptedInput.handles[1],\n        encryptedInput.inputProof\n      );\n\n      setMessage(`Transaction submitted: ${tx.hash}. Waiting for confirmation...`);\n      await tx.wait();\n      setMessage(\"Donation submitted successfully!\");\n      setDonationAmount(\"\");\n      await loadDonationRecords();\n    } catch (error: any) {\n      console.error(\"Error submitting donation:\", error);\n      setMessage(`Error: ${error.message || \"Failed to submit donation\"}`);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleDecryptRecord = async (recordId: number) => {\n    if (!isConnected || !ethersSignerPromise || !zama || !contractAddress || !address) {\n      setMessage(\"Please connect wallet\");\n      return;\n    }\n\n    setDecryptingRecordId(recordId);\n    setMessage(`Decrypting record ${recordId}...`);\n\n    try {\n      const signer = await ethersSignerPromise;\n      const contract = new ethers.Contract(\n        contractAddress,\n        EncryptedDonationLogABI.abi,\n        signer\n      );\n\n      const encryptedAmount = await contract.getEncryptedAmount(recordId);\n      const encryptedTimestamp = await contract.getEncryptedTimestamp(recordId);\n\n      // Check if handles are zero (uninitialized)\n      if (encryptedAmount === ethers.ZeroHash || encryptedTimestamp === ethers.ZeroHash) {\n        setMessage(\"Record is not initialized\");\n        return;\n      }\n\n      // Generate keypair for decryption\n      const keypair = zama.generateKeypair();\n\n      // Decrypt amount\n      const amountHandlePairs = [{\n        handle: encryptedAmount,\n        contractAddress: contractAddress,\n      }];\n\n      const startTimeStamp = Math.floor(Date.now() / 1000).toString();\n      const durationDays = \"10\";\n      const contractAddresses = [contractAddress];\n\n      const eip712 = zama.createEIP712(\n        keypair.publicKey,\n        contractAddresses,\n        startTimeStamp,\n        durationDays\n      );\n\n      // Sign typed data\n      const signature = await signer.signTypedData(\n        eip712.domain,\n        {\n          UserDecryptRequestVerification: eip712.types.UserDecryptRequestVerification,\n        },\n        eip712.message\n      );\n\n      // Decrypt amount\n      const amountResult = await zama.userDecrypt(\n        amountHandlePairs,\n        keypair.privateKey,\n        keypair.publicKey,\n        signature.replace(\"0x\", \"\"),\n        contractAddresses,\n        address,\n        startTimeStamp,\n        durationDays,\n      );\n\n      const decryptedAmount = amountResult[encryptedAmount];\n\n      // Decrypt timestamp (generate new keypair for second decryption)\n      const timestampKeypair = zama.generateKeypair();\n      const timestampHandlePairs = [{\n        handle: encryptedTimestamp,\n        contractAddress: contractAddress,\n      }];\n\n      const timestampEip712 = zama.createEIP712(\n        timestampKeypair.publicKey,\n        contractAddresses,\n        startTimeStamp,\n        durationDays\n      );\n\n      const timestampSignature = await signer.signTypedData(\n        timestampEip712.domain,\n        {\n          UserDecryptRequestVerification: timestampEip712.types.UserDecryptRequestVerification,\n        },\n        timestampEip712.message\n      );\n\n      const timestampResult = await zama.userDecrypt(\n        timestampHandlePairs,\n        timestampKeypair.privateKey,\n        timestampKeypair.publicKey,\n        timestampSignature.replace(\"0x\", \"\"),\n        contractAddresses,\n        address,\n        startTimeStamp,\n        durationDays,\n      );\n\n      const decryptedTimestamp = timestampResult[encryptedTimestamp];\n\n      // Update the record in the list\n      setDonationRecords(prev => prev.map(record => \n        record.recordId === recordId \n          ? {\n              ...record,\n              amount: decryptedAmount.toString(),\n              timestamp: new Date(Number(decryptedTimestamp) * 1000).toLocaleString(),\n            }\n          : record\n      ));\n\n      setMessage(`Record ${recordId} decrypted successfully!`);\n    } catch (error: any) {\n      console.error(\"Error decrypting record:\", error);\n      setMessage(`Error: ${error.message || \"Failed to decrypt record\"}`);\n    } finally {\n      setDecryptingRecordId(null);\n    }\n  };\n\n  if (!mounted) {\n    return (\n      <div className=\"mx-auto mt-20\">\n        <div className=\"bg-white rounded-xl p-8 shadow-lg\">\n          <h2 className=\"text-2xl font-bold mb-4 text-center\">Loading...</h2>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isConnected) {\n    return (\n      <div className=\"mx-auto mt-20\">\n        <div className=\"bg-white rounded-xl p-8 shadow-lg\">\n          <h2 className=\"text-2xl font-bold mb-4 text-center\">Connect Your Wallet</h2>\n          <p className=\"text-gray-600 mb-6 text-center\">Please connect your wallet to start using the Encrypted Donation Log</p>\n          <div className=\"flex justify-center\">\n            <ConnectButton />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isDeployed) {\n    const chainName = chainId === 31337 ? 'Hardhat Local (31337)' : chainId === 11155111 ? 'Sepolia (11155111)' : `Chain ${chainId || 'unknown'}`;\n    return (\n      <div className=\"mx-auto mt-20\">\n        <div className=\"bg-white rounded-xl p-8 shadow-lg\">\n          <h2 className=\"text-2xl font-bold mb-4 text-center text-red-600\">Contract Not Deployed</h2>\n          <p className=\"text-gray-600 text-center mb-4\">\n            The EncryptedDonationLog contract is not deployed on {chainName}. Please deploy it first.\n          </p>\n          <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4 mt-4 mb-4\">\n            <p className=\"text-sm text-gray-700 mb-2\">\n              <strong>Debug Info:</strong>\n            </p>\n            <p className=\"text-xs text-gray-600 font-mono\">\n              Detected Chain ID: {chainId || 'undefined'}<br />\n              Contract Address: {contractAddress || 'Not found'}<br />\n              Wallet Connected: {isConnected ? 'Yes' : 'No'}\n            </p>\n          </div>\n          {chainId === 31337 && (\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4\">\n              <p className=\"text-sm text-blue-800\">\n                <strong>For Local Network:</strong> Make sure Hardhat node is running and run:<br />\n                <code className=\"bg-blue-100 px-2 py-1 rounded\">npx hardhat deploy --network localhost</code>\n              </p>\n            </div>\n          )}\n          {chainId === 11155111 && (\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4\">\n              <p className=\"text-sm text-yellow-800\">\n                <strong>Note:</strong> You are connected to Sepolia testnet. Switch to Hardhat Local (31337) to use the local contract, or deploy the contract to Sepolia.\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  // Show relayer error message if on Sepolia\n  const showRelayerError = chainId === 11155111 && zamaError && \n    (zamaError.includes('relayer') || zamaError.includes('Relayer') || zamaError.includes('network issue'));\n\n  return (\n    <div className=\"grid w-full gap-6 px-4\">\n      <div className=\"flex justify-end items-center gap-3\">\n        <ConnectButton />\n      </div>\n\n      {showRelayerError && (\n        <div className=\"bg-yellow-50 border-2 border-yellow-400 rounded-xl p-4 shadow-lg\">\n          <div className=\"flex items-start gap-3\">\n            <div className=\"text-yellow-600 text-xl\">‚ö†Ô∏è</div>\n            <div className=\"flex-1\">\n              <h3 className=\"text-lg font-semibold text-yellow-800 mb-2\">\n                Zama Relayer Service Unavailable\n              </h3>\n              <p className=\"text-yellow-700 mb-3\">\n                The Zama relayer service for Sepolia testnet is currently unavailable. This may be due to:\n              </p>\n              <ul className=\"list-disc list-inside text-yellow-700 mb-3 space-y-1 text-sm\">\n                <li>Network connectivity issues</li>\n                <li>Temporary service outage</li>\n                <li>Firewall or proxy restrictions</li>\n              </ul>\n              <div className=\"bg-white rounded-lg p-3 mt-3\">\n                <p className=\"text-sm font-semibold text-gray-800 mb-2\">üí° Recommended Solution:</p>\n                <p className=\"text-sm text-gray-700\">\n                  Switch to <strong>Hardhat Local (31337)</strong> network to use mock mode for testing. \n                  Mock mode doesn't require the relayer service and works offline.\n                </p>\n                <p className=\"text-xs text-gray-600 mt-2\">\n                  To switch: Click the wallet button above ‚Üí Select \"Hardhat Local\" network\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n        <h2 className=\"text-2xl font-bold mb-4\">Submit New Donation</h2>\n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Donation Amount\n            </label>\n            <input\n              type=\"number\"\n              value={donationAmount}\n              onChange={(e) => setDonationAmount(e.target.value)}\n              placeholder=\"Enter amount\"\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent\"\n              disabled={isSubmitting || zamaLoading}\n            />\n          </div>\n          <button\n            onClick={handleSubmitDonation}\n            disabled={isSubmitting || zamaLoading || !donationAmount}\n            className=\"w-full bg-purple-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n          >\n            {isSubmitting ? \"Submitting...\" : zamaLoading ? \"Loading...\" : \"Submit Encrypted Donation\"}\n          </button>\n        </div>\n      </div>\n\n      <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n        <div className=\"flex justify-between items-center mb-4\">\n          <h2 className=\"text-2xl font-bold\">My Donation Records</h2>\n          <button\n            onClick={loadDonationRecords}\n            disabled={isLoadingRecords}\n            className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50\"\n          >\n            {isLoadingRecords ? \"Loading...\" : \"Refresh\"}\n          </button>\n        </div>\n\n        {donationRecords.length === 0 ? (\n          <p className=\"text-gray-500 text-center py-8\">No donation records found</p>\n        ) : (\n          <div className=\"space-y-4\">\n            {donationRecords.map((record) => (\n              <div key={record.recordId} className=\"border border-gray-200 rounded-lg p-4\">\n                <div className=\"flex justify-between items-start\">\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm text-gray-500\">Record ID: {record.recordId}</p>\n                    <p className=\"text-lg font-semibold mt-2\">\n                      Amount: {record.amount}\n                    </p>\n                    <p className=\"text-sm text-gray-600 mt-1\">\n                      Timestamp: {record.timestamp}\n                    </p>\n                    <p className=\"text-xs text-gray-400 mt-1\">\n                      Block: {record.blockNumber}\n                    </p>\n                  </div>\n                  {record.amount === \"Encrypted\" && (\n                    <button\n                      onClick={() => handleDecryptRecord(record.recordId)}\n                      disabled={decryptingRecordId === record.recordId || zamaLoading}\n                      className=\"ml-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                    >\n                      {decryptingRecordId === record.recordId ? \"Decrypting...\" : \"Decrypt\"}\n                    </button>\n                  )}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {message && (\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n          <p className=\"text-blue-800\">{message}</p>\n        </div>\n      )}\n\n      {zamaError && (\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n          <p className=\"text-red-800\">Zama Error: {zamaError}</p>\n        </div>\n      )}\n    </div>\n  );\n};\n\n"],"names":[],"mappings":"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","debugId":null}}]
}